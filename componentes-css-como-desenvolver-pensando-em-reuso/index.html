<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
    <link rel="canonical" href="https://fernahh.com.br/componentes-css-como-desenvolver-pensando-em-reuso/">

    <title>Componentes CSS: como desenvolver pensando em reuso | fernahh</title>

    <link rel="apple-touch-icon" href="/apple-touch-icon.jpg" />
    <link rel="icon" href="/favicon-cd3c3b6e.png" />

    <meta name="description" content="Cada vez mais precisamos de aplicações dinâmicas e modularizadas. E como criar componentes encapsulados em uma linguagem onde tudo é global? Veremos aqui paradigmas e aprender como desenvolver CSS escalável em tempos de módulos JavaScript e Web Components."></meta>
    <meta property="og:type" content="article"></meta>
    <meta property="og:title" content="Componentes CSS: como desenvolver pensando em reuso | fernahh."></meta>
    <meta property="og:site_name" content="fernahh. desenvolvedor e de buenas na web."></meta>
    <meta property="og:description" content="Cada vez mais precisamos de aplicações dinâmicas e modularizadas. E como criar componentes encapsulados em uma linguagem onde tudo é global? Veremos aqui paradigmas e aprender como desenvolver CSS escalável em tempos de módulos JavaScript e Web Components."></meta>

    <meta name="twitter:card  " content="summary"></meta>
    <meta name="twitter:site" content="fernahh."></meta>
    <meta name="twitter:creator" content="@fernahh"></meta>
    <meta name="twitter:url" content="https://fernahh.com.br/componentes-css-como-desenvolver-pensando-em-reuso/"></meta>
    <meta name="twitter:title" content="Componentes CSS: como desenvolver pensando em reuso | fernahh."></meta>
    <meta name="twiter:description" content="Cada vez mais precisamos de aplicações dinâmicas e modularizadas. E como criar componentes encapsulados em uma linguagem onde tudo é global? Veremos aqui paradigmas e aprender como desenvolver CSS escalável em tempos de módulos JavaScript e Web Components."></meta>
    <link href="../assets/stylesheets/application-f11de034.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="componentes-css-como-desenvolver-pensando-em-reuso componentes-css-como-desenvolver-pensando-em-reuso_index">
    <div class="Container">
      <div class="Header_Navigation">
  <header class="Header">
    <h1>
<a title="fernahh.com.br" href="/">        <strong>fernahh</strong>.
</a>    </h1>
  </header>
</div>

        <article class="Article" role="article">
    <header>
    <time class="Post_Index__Date" datetime="2016/02/15">
      Publicado em: 15/02/2016</time>
      <h1 class="Article__Title">Componentes CSS: como desenvolver pensando em reuso</h1>
    </header>
    <section>
      <p>A palavra <em>&ldquo;componente&rdquo;</em> nunca foi tão usada na web como nos últimos meses. Na era de bem-sucedidos <em>frameworks</em> e bibliotecas como <a href="https://facebook.github.io/react/">React</a> e <a href="https://angular.io/">Angular2</a>, que se baseiam nesse conceito, é cada vez mais necessário investir tempo em como arquitetar nosso CSS. A velha e boa técnica de <em>dividir para conquistar</em> mais do que nunca nos é uma boa opção.</p>

<p>Para definir um componente, ele deve ser <strong>auto-suficiente</strong>, capaz de <strong>encapsular</strong> funcionalidades e permitir uma <strong>API de acesso</strong>. Pensando do ponto de vista de um seletor CSS, vamos exemplificar com um componente de botão:</p>
<pre class="highlight css"><code>  <span class="nc">.Button</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
    <span class="nl">max-width</span><span class="p">:</span> <span class="m">300px</span><span class="p">;</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre>

<p>Levando em conta a definição literal, podemos dizer que esse componente é auto-suficiente, afinal, se usarmos somente ele teremos um estilo de botão. Porém, não temos uma API de acesso bem definida, com entrada e saída. Problemas como esse são comuns e inevitáveis com CSS puro. Eles são ainda mais frequentes quando precisamos lidar com aplicações complexas.</p>

<p>Uma das formas encontradas para contornar nossos problemas com CSS foram <a href="http://tableless.com.br/oocss-smacss-bem-dry-css-afinal-como-escrever-css/">metodologias de escrita</a>, como BEM, OOCSS, SMACSS e DRYCSS. Mesmo assim, elas são facilmente burláveis, afinal não há como controlarmos algo em uma linguagem que não nos lança exceção.</p>

<p>Antes de continuar a leitura, recomendo que entenda como funciona a <a href="http://tableless.com.br/afinal-como-usar-heranca-no-css/">especificidade de seletores e henraça em CSS</a>.</p>

<h2>Escopo global, <em>refactoring</em> e estados</h2>

<p>Se pudéssemos elencar três problemas sérios com nossas queridas folhas de estilo, podemos dizer que são: escopo global, difícil de refatorar e custoso para lidar com estados.</p>

<p><em>Escopo Global</em> é de longe algo que sabemos que é ruim. Se você visitar a página sobre <a href="http://www.w3schools.com/js/js_best_practices.asp">boas práticas JavaScript no w3fools</a>, irá ver que funções e variáveis globais são ruins. Com CSS não é diferente. O problema é que quando pensamos em uma página <em>web</em>, logo imaginamos uma árvore. Porém, se levarmos em conta o <a href="https://www.w3.org/TR/2013/WD-cssom-20131205/">CSSOM</a>, veremos que todos os seletores fazem parte do mesmo escopo:</p>

<p><img alt="escopo global de seletores" src="http://i.imgur.com/8xNFR7c.jpg?1" /></p>

<p>Isso é a cascata. Um seletor filho sempre irá herdar os estilos do pai. Por anos convivemos com ela e aprendemos a tirar proveito disso. O <a href="http://getbootstrap.com/">Bootstrap</a>, <em>framework</em> CSS mais bem sucedido até então, faz uso bem inteligente do efeito cascata. Porém, em um cenário que desejamos encapsular funcionalidades, o efeito cascata pode ser um grande inimigo. Voltando ao nosso componente de botão, vamos entender porque a cascata pode ser prejudicial há um componente.</p>

<p>Vamos analisar o exemplo abaixo:</p>

<p data-height="255" data-theme-id="0" data-slug-hash="EPMYMy" data-default-tab="result" data-user="fernahh" class='codepen'>See the Pen <a href='http://codepen.io/fernahh/pen/EPMYMy/'>EPMYMy</a> by fernahh (<a href='http://codepen.io/fernahh'>@fernahh</a>) on <a href='http://codepen.io'>CodePen</a>.</p>

<script async src="//assets.codepen.io/assets/embed/ei.js"></script>

<p>Nosso componente <code>.Button</code> herdou o estilo da propriedade <code>text-transform</code> do componente <code>.Dropdown</code> e seus filhos. Dessa forma podemos provar que o componentes com CSS puro não encapsulam estilo, afinal eles &ldquo;vazam&rdquo; para outros componentes de nossa página.</p>

<p>O segundo problema que temos com CSS é <em>refactoring</em>. Através do <a href="http://httparchive.org/">httparchive.org</a> podemos analisar que as folhas de estilo só crescem. Em cinco anos, pulamos de arquivos de 10kb para 80kb. Obviamente precisamos levar todo o contexto do crescimento da web, mas também devemos ser sinceros e admitir que é sempre mais fácil adicionar uma nova regra ao refatorar algo antigo. Quem nunca adicionou uma nova regra ao <em>markup</em> ao invés de refatorar o que existe que atire a primeira pedra.</p>

<p>Uma das soluções nativas para resolver o problema com escopo de seletores é o <a href="https://www.w3.org/TR/shadow-dom/">Shadow DOM</a>. Resumidamente, ele nada mais é uma API que nos permite criar elementos de DOM <strong>independentes</strong> e <strong>isolados</strong> do restante da página, ou seja, uma DOM isolada dentro da própria DOM.</p>

<p>As vantagens dessa abordagem é que faz parte de um pequeno grupo de tecnologias que possuimos para isolar marcação, comportamento e estilo. Além disso, componentes criados com Shadow DOM podem receber parâmetros. Porém, nem tudo é perfeito. O isolamento de escopo que nos permite criar <em>widgets</em> como a tag <code>&lt;video&gt;</code> e <code>&lt;audio&gt;</code>, é prejudicional falando de estilo. Isso porque a cada Shadow DOM, sua página perde o estilo. Por final, sem contar que <a href="http://caniuse.com/#feat=shadowdom">não funciona no IE/Edge, Firefox e Safari</a> e não resolve problemas com estado.</p>

<p>Falando em estado, esse parece ser nosso grande desafio. No <em>JavaScript</em> estamos carecas de saber que é custoso manipularmos o <em>DOM</em>. Quando lidamos com estado, é isso que precisamos fazer: <strong>adicionar e remover estilo dependendo do estado de nosso componente</strong>. Pensando em resolver esse problema, na <a href="https://www.youtube.com/watch?v=NoaxsCi13yQ">CSSConf</a> de 2015, <a href="https://twitter.com/colinmegill">Colin Megill</a> apresentou uma palestra com um nome polêmico: <strong>Inline Styles are About to Kill CSS</strong>. Recomendo você assistir, no mínimo você ficará em choque com o turbilhão de informações ou irá achar que o cara é maluco. Enfim, essa <em>talk</em> foi importante no ponto de levantar diversas discussões na comunidade <em>web</em> sobre a tal &ldquo;morte das folhas de estilo&rdquo;.</p>

<p><a href="https://facebook.github.io/react/tips/inline-styles.html">Inline Styles</a> surgiu com o React, que por sinal é a biblioteca que melhor lida com estados na atualidade. Desse ponto de vista, faz muito sentido, afinal a performance será bem melhor, temos regras encapsuladas e faz todo sentido quando lidamos com visualização de dados. Porém temos outros problemas, principalmente porque não há como cachear estilo <em>inline</em>.</p>

<p>Ainda antes dessa palestra do Megill, um dos engenheiros do <a href="https://facebook.github.io/">Facebook</a>, <a href="http://blog.vjeux.com/">Christopher Chedeau</a> cutucou diretamente em nossas feridas, principalmente no slide abaixo:</p>

<p><img alt="CSS Problems" src="http://i.imgur.com/wBw0LL2.jpg?1" /></p>

<p>Esse slide foi tão importante que, provavelmente, irá mudar nossa forma de estilizar com CSS. Uma das formas disponíveis que surgiram são os <a href="https://github.com/css-modules/css-modules">CSS Modules</a>.</p>

<h2>CSS Modules: o futuro passa por aqui</h2>

<p>Desde a revolução dos pré-processadores, não tivemos nenhuma grande iniciativa que nos fizesse repensar nossa forma de escrever CSS. Mas isso pode mudar quando falamos de CSS Modules.</p>

<p>Resumidamente, podemos definir essa tecnologia como <strong>folhas de estilo que possuem escopo local</strong>. Aqui já podemos concluir que precisamos de uma tarefa de <em>build</em>, pois CSS Modules não funcionam nativamente.</p>

<p>Na prática, supomos um cenário com nosso mesmo componente de botão:</p>
<pre class="highlight css"><code>  <span class="c">/* components/button.css */</span>
  <span class="nc">.Button</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
    <span class="nl">max-width</span><span class="p">:</span> <span class="m">300px</span><span class="p">;</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="no">black</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nc">.danger</span> <span class="p">{</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre>

<p>Para usar esse componente, precisaremos importar esse módulo em um componente JavaScript:</p>
<pre class="highlight javascript"><code>  <span class="cm">/* components/button.js */</span>
  <span class="kr">import</span> <span class="nx">button</span> <span class="nx">from</span> <span class="s1">'./button.css'</span><span class="p">;</span>

  <span class="nx">buttonElem</span><span class="p">.</span><span class="nx">outerHTML</span> <span class="o">=</span> <span class="err">`</span><span class="o">&lt;</span><span class="nx">button</span> <span class="kr">class</span><span class="o">=</span><span class="nx">$</span><span class="p">{</span><span class="nx">button</span><span class="p">.</span><span class="nx">danger</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Enviar</span><span class="o">&lt;</span><span class="sr">/button&gt;</span><span class="err">`
</span></code></pre>

<p>Nossos <em>output</em> de CSS será como no <em>snippet</em> a seguir:</p>
<pre class="highlight css"><code>  <span class="nc">.components_Button__danger__abc5436-20WEds96_Ee1ra54</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
    <span class="nl">max-width</span><span class="p">:</span> <span class="m">300px</span><span class="p">;</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre>

<p>Através desse breve <em>overview</em> podemos notar que há uma mudança de <em>workflow</em> na forma de desenvolvermos CSS. O nome gerado no <em>output</em> nos leva a conclusão que precisamos de <code>sourcemaps</code> para <em>debugging</em>. Além disso, você deve estar se perguntando:</p>

<blockquote>
<p>&ldquo;Como faço para usar herança?&rdquo;</p>
</blockquote>

<p>Podemos definir regras globais com CSS Modules, através da declaração com a seguinte sintaxe:</p>
<pre class="highlight css"><code>  <span class="nd">:global</span><span class="o">(</span><span class="nc">.Button</span><span class="o">)</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
    <span class="nl">max-width</span><span class="p">:</span> <span class="m">300px</span><span class="p">;</span>
    <span class="nl">background-color</span><span class="p">:</span> <span class="no">red</span><span class="p">;</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre>

<p>Isso quer dizer que o módulo <code>.Button</code> estará disponível para todos os módulos de nossa aplicação. Além disso temos a <em>keyword</em> <code>composes</code>, que receberá um módulo. Se você já captou a ideia, deverá ter percebido que funciona parecido com o <code>@extend</code> do Sass.</p>
<pre class="highlight css"><code>  <span class="nc">.Button_group</span> <span class="p">{</span>
    <span class="py">composes</span><span class="p">:</span> <span class="n">button</span> <span class="n">from</span> <span class="s2">'../componentes/button.css'</span><span class="p">;</span>
  <span class="p">}</span>
</code></pre>

<p>Além disso também podemos gerenciar dependências de componentes através de <a href="http://www.2ality.com/2014/09/es6-modules-final.html">módulos <em>JavaScript</em></a>.</p>

<h2>Conclusão</h2>

<p>Até os mais puristas (me incluo nesse grupo) precisam dar o braço a torcer e aceitar que apenas HTML, CSS e JavaScript não são mais suficientes para desenvolvermos aplicações ricas. A <em>web</em> evoluiu a um nível que necessita de ferramentas auxiliares no dia-a-dia do desenvolvedor <em>front-end</em>. <strong>CSS Modules é mais uma delas</strong>.</p>

<p>Precisamos testar, arriscar e utilizar isso em nossos produtos. Apenas dessa forma poderemos dizer se algo irá nos servir ou não.</p>

<p>Ah, e pra não esquecer, <strong>sempre aposte em ideias e iniciativas da comunidade</strong>.</p>

    </section>
  </article>

      <footer class="Footer">
  <div>
    <nav class="Navigation">
  <ul class="Navigation__List">
    <li class="Navigation__List__Item">
<a class="Navigation__List__Item__Link" title="Link para o Twitter" href="https://twitter.com/fernahh">        Twitter
</a>    </li>
    <li class="Navigation__List__Item">
<a class="Navigation__List__Item__Link" title="Projetos no Github" href="https://github.com/fernahh">        Github
</a>    </li>
    <li class="Navigation__List__Item">
<a class="Navigation__List__Item__Link" title="Perfil no LinkedIn" href="https://www.linkedin.com/in/fernahh">        LinkedIn
</a>    </li>
  </ul>
</nav>

  </div>
</footer>

    </div>

    <script src="../assets/javascripts/application-56d518d4.js" type="text/javascript"></script>
  </body>
</html>
