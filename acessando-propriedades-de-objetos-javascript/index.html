<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
    <link rel="canonical" href="https://fernahh.com.br/acessando-propriedades-de-objetos-javascript/">

    <title>Acessando propriedades de objetos JavaScript | fernahh</title>

    <link rel="apple-touch-icon" href="/apple-touch-icon.jpg" />
    <link rel="icon" href="/favicon-cd3c3b6e.png" />

    <meta name="description" content="Como garantir que uma propriedade de um objeto estará definida quando você precisar dela? Esse artigo mostra as várias formas de fazer isso, através condicionais, bibliotecas e conceitos de programação funcional."></meta>
    <meta property="og:type" content="article"></meta>
    <meta property="og:title" content="Acessando propriedades de objetos JavaScript | fernahh."></meta>
    <meta property="og:site_name" content="fernahh. desenvolvedor e de buenas na web."></meta>
    <meta property="og:description" content="Como garantir que uma propriedade de um objeto estará definida quando você precisar dela? Esse artigo mostra as várias formas de fazer isso, através condicionais, bibliotecas e conceitos de programação funcional."></meta>

    <meta name="twitter:card  " content="summary"></meta>
    <meta name="twitter:site" content="fernahh."></meta>
    <meta name="twitter:creator" content="@fernahh"></meta>
    <meta name="twitter:url" content="https://fernahh.com.br/acessando-propriedades-de-objetos-javascript/"></meta>
    <meta name="twitter:title" content="Acessando propriedades de objetos JavaScript | fernahh."></meta>
    <meta name="twiter:description" content="Como garantir que uma propriedade de um objeto estará definida quando você precisar dela? Esse artigo mostra as várias formas de fazer isso, através condicionais, bibliotecas e conceitos de programação funcional."></meta>

    <link href="https://fonts.googleapis.com/css?family=Muli:300,400,800" rel="stylesheet">
    <link href="../assets/stylesheets/application-3e8dbfbc.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="acessando-propriedades-de-objetos-javascript acessando-propriedades-de-objetos-javascript_index">
    <div class="Container">
      <div class="Header_Navigation">
  <header class="Header">
    <h1>
<a title="fernahh.com.br" href="/">        <strong>fernahh</strong>.
</a>    </h1>
  </header>
</div>

        <article class="Article" role="article">
    <header>
    <time class="Post_Index__Date" datetime="2017/02/20">
      Publicado em: 20/02/2017</time>
      <h1 class="Article__Title">Acessando propriedades de objetos JavaScript</h1>
    </header>
    <section>
      <p>O JavaScript, como várias linguagens, funciona com um único fluxo de execução. Isso quer dizer que dadas as instruções, elas serão executadas em ordem e de forma contínua. Caso algo quebre no meio do caminho, a execução é interrompida. Isso pode nos ocasionar momentos desastrosos. No browser, a execução do JavaScript é compartilhada com a renderização do layout.</p>

<blockquote>
<p>Para saber mais sobre fluxo de execução em JavaScript, sugiro que leia <a href="https://tableless.com.br/fluxo-de-execucao-assincrono-em-javascript-callbacks/">esse artigo do @jcemer no Tableless.</a></p>
</blockquote>

<p>Uma forma de quebrar a execução, é tentar acessar a propriedade de algum valor que não é definido. Isso irá quebrar o fluxo de execução, e dependendo da posição em que está sendo executado, pode deixar o usuário sem experiência alguma.</p>
<pre class="highlight javascript"><code>  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">y</span> <span class="c1">// TypeError: Cannot read property 'y' of undefined</span>
</code></pre>

<p>Parece fácil prever erros como esse, mas é bem comum precisarmos consultar um valor que é definido de forma assíncrona. Além disso, em aplicações complexas não temos garantia sobre todas suas informações. Para evitar erros como esse, geralmente verificamos propriedade a propriedade:</p>
<pre class="highlight javascript"><code>  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">x</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">y</span> <span class="c1">// undefined</span>
</code></pre>

<p>O problema com esssa abordagem é que dependendo do nível de nesting, mais ilegível nosso código fica.</p>

<h2>Optional Chaining</h2>

<p>Existe uma proposta de especificação do ECMAScript para resolver esse problema. Ela se chama <a href="https://claudepache.github.io/es-optional-chaining/">Optional Chaining</a>. Em resumo, a proposta diz que o operador <code>?.</code> pode ser usado para verificar se um valor existe e evitar uma quebra de fluxo.</p>

<p>Usando nosso exemplo, podemos verificar se <code>x</code> existe através do operador <em>optional chaining</em>.</p>
<pre class="highlight javascript"><code>  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="k">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">x</span><span class="p">?.</span><span class="nx">y</span> <span class="c1">// undefined</span>
</code></pre>

<p>É bom lembrar que essa proposta ainda está em <em>state 0</em>, e não é recomendada para uso.</p>

<p>Outras linguagens, como <em>Ruby</em> e <em>C#</em>, já possuem essa feauture. O <em>Ruby on Rails</em>, possui um método chamado <code>try()</code> , que também possui esse objetivo.</p>

<h2>Try method</h2>

<p>O <code>try()</code> method, que o Rails dispõe, pode ser usado para consultador valores públicos de um objeto. Caso ele não exista, é retornado <code>nil</code> . Outra característica é que ele pode ser “chained” <em>(quem não lembra da jQuery nesse momento?):</em></p>
<pre class="highlight ruby"><code>  <span class="vi">@obj</span><span class="p">.</span><span class="nf">try</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="nf">try</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre>

<p>Outra feature mais interessante, é que você pode usar bloco e seus parâmetros, passando esses valores para um método que pode existir ou não:</p>
<pre class="highlight ruby"><code>  <span class="vi">@posts</span><span class="p">.</span><span class="nf">try</span><span class="p">(</span><span class="ss">:each_slice</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">|</span>
    <span class="p">.</span><span class="nf">.</span><span class="p">.</span>
  <span class="nf">end</span>
</code></pre>

<h3>try.js</h3>

<p>Inspirado por esse método, decidi implementar algo parecido em JavaScript. Publiquei a implementação em uma pequena biblioteca no NPM. Caso queira ver o código, <a href="https://github.com/fernahh/try.js">está no GitHub</a>.</p>

<p>Não há nada de mágico e inovador, a biblioteca serve apenas para momentos em que não podemos garantir o <em>path</em> de um objeto. Seguindo nosso exemplo, ao invés de varrer propriedade a propriedade, podemos passar o <em>path</em> como parâmetro para a função:</p>
<pre class="highlight javascript"><code>  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="nx">tryjs</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">'y.x'</span><span class="p">)</span> <span class="c1">// undefined</span>
</code></pre>

<p>Também é possível executar uma função e passar parâmetros pra ela:</p>
<pre class="highlight javascript"><code>  <span class="c1">// sem try.js</span>
  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">sayHello</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="s1">'Hello'</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">sayHello</span> <span class="o">===</span> <span class="s1">'function'</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">sayHello</span><span class="p">()</span> <span class="c1">// 'Hello'</span>

  <span class="c1">// com try.js</span>
  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">sayHello</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="s1">'Hello'</span>
  <span class="p">}</span>
  <span class="nx">tryjs</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">'sayHello'</span><span class="p">)</span> <span class="c1">// 'Hello'</span>

  <span class="c1">// com parâmetros</span>
  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">add</span><span class="p">:</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span>
  <span class="p">}</span>
  <span class="nx">tryjs</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">'add'</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="c1">// 3</span>
</code></pre>

<p>Quando tive a ideia da biblioteca, fui trocar uma ideia com meu amigo <a href="http://rodrigowillrich">@rodrigowillrich</a>. Na ocasião, ele me mostrou algumas implementações que resolvem esse problema e são elas que vamos ver agora.</p>

<h2>Lodash e Ramda</h2>

<p>A <a href="https://lodash.com/">Lodash</a> possui uma função chamada <code>_.get()</code> , que faz a consulta de um valor e retorna um valor <em>default</em> caso ele não exista.</p>
<pre class="highlight javascript"><code>  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="nx">_</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="s1">'x.y'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">// 1</span>
</code></pre>

<p>O <a href="http://ramdajs.com">Ramda</a> também possui uma função que pode ser usada pra esse caso. A sintax é o contrário da implementação da Lodash:</p>
<pre class="highlight javascript"><code>  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="nx">R</span><span class="p">.</span><span class="nx">prop</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="c1">// undefined</span>
</code></pre>

<p>Existem outros milhões de funções do Ramda, outras bem parecidas que podem ser usadas também, dependendo do problema que você precisa resolver.</p>

<h2>Lenses</h2>

<p>Lenses é um conceito da Programação Funcional. De forma simplória, podemos dizer que lenses são <strong>getters/setters</strong> funcionais. Isso tem tudo a ver com o assunto desse artigo, onde tentamos acessar propriedades de objetos. Uma implementação simples, seria algo como:</p>
<pre class="highlight javascript"><code>  <span class="kr">const</span> <span class="nx">lens</span> <span class="o">=</span> <span class="p">(</span><span class="nx">getter</span><span class="p">,</span> <span class="nx">setter</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">({</span>
      <span class="na">get</span><span class="p">:</span> <span class="nx">obj</span> <span class="o">=&gt;</span> <span class="nx">getter</span><span class="p">(</span><span class="nx">obj</span><span class="p">),</span>
      <span class="na">set</span><span class="p">:</span> <span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">setter</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">obj</span><span class="p">),</span>
    <span class="p">})</span>
  <span class="p">}</span>
</code></pre>

<p>Essa função, <code>lens()</code> irá nos retornar um objeto com função de <em>get</em> e <em>set</em>. Feito isso, podemos acessar e mudar valor de objetos sem precisar <strong>&ldquo;mutar&rdquo;</strong> nosso objeto nativo. Isso faz bastante sentido quando lidamos com imutabilidade. No exemplo abaixo, o objeto R representa o <a href="http://ramdajs.com/">ramda</a>.</p>
<pre class="highlight javascript"><code>  <span class="kr">const</span> <span class="nx">lens</span> <span class="o">=</span> <span class="p">(</span><span class="nx">getter</span><span class="p">,</span> <span class="nx">setter</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">({</span>
      <span class="na">get</span><span class="p">:</span> <span class="nx">obj</span> <span class="o">=&gt;</span> <span class="nx">getter</span><span class="p">(</span><span class="nx">obj</span><span class="p">),</span>
      <span class="na">set</span><span class="p">:</span> <span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">setter</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">obj</span><span class="p">),</span>
    <span class="p">})</span>
  <span class="p">}</span>
  <span class="kr">const</span> <span class="nx">view</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lens</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">lens</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span>
  <span class="kr">const</span> <span class="nx">set</span> <span class="o">=</span> <span class="p">(</span><span class="nx">lens</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">lens</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span>

  <span class="kr">const</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span> <span class="na">x</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span>
  <span class="kr">const</span> <span class="nx">xLens</span> <span class="o">=</span> <span class="nx">lens</span><span class="p">(</span><span class="nx">R</span><span class="p">.</span><span class="nx">prop</span><span class="p">(</span><span class="s1">'x'</span><span class="p">),</span> <span class="nx">R</span><span class="p">.</span><span class="nx">assoc</span><span class="p">(</span><span class="s1">'x'</span><span class="p">))</span>

  <span class="kr">const</span> <span class="nx">newObj</span> <span class="o">=</span> <span class="nx">set</span><span class="p">(</span><span class="nx">xLens</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span>
  <span class="nx">newObj</span><span class="p">.</span><span class="nx">x</span> <span class="c1">// return 3</span>
  <span class="nx">obj</span><span class="p">.</span><span class="nx">x</span> <span class="c1">// return 1</span>
</code></pre>

<p>Essa explicação é extramamente básica. Sugiro que para se aprofundar no assunto, dê uma lida no artigo do @sharifsbeat, <a href="https://medium.com/javascript-inside/an-introduction-into-lenses-in-javascript-e494948d1ea5">A Introduction into Lenses in JavaScript</a>, onde há outras links e referências.</p>

<h2>Conclusão</h2>

<p>Acessar e como acessar propriedades em JavaScript já possui várias soluções. O interessante aqui é acompanhar e saber qual vai ser a implementação que o futuro da linguagem irá seguir. Como outras inúmeras features, acesso a propriedades de objetos pode fazer parte de um marco importante para o JavaScript, onde saberemos se ele continuará características funcionais ou OOP.</p>

    </section>
  </article>

      <footer class="Footer">
  <div>
    <nav class="Navigation">
  <ul class="Navigation__List">
    <li class="Navigation__List__Item">
<a class="Navigation__List__Item__Link" title="Link para o Twitter" href="https://twitter.com/fernahh">        Twitter
</a>    </li>
    <li class="Navigation__List__Item">
<a class="Navigation__List__Item__Link" title="Projetos no Github" href="https://github.com/fernahh">        Github
</a>    </li>
    <li class="Navigation__List__Item">
<a class="Navigation__List__Item__Link" title="Perfil no LinkedIn" href="https://www.linkedin.com/in/fernahh">        LinkedIn
</a>    </li>
  </ul>
</nav>

  </div>
</footer>

    </div>

    <script src="../assets/javascripts/application-56d518d4.js" type="text/javascript"></script>
  </body>
</html>
